<!-- !DOCTYPE html -->
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />

  <!-- requirements: -->
  <script src="javascripts/jquery-1.4.2.js"></script>
  <script src="javascripts/jquery-ui-1.8.custom.min.js"></script>

  <!-- now load Repertoire Chronos: -->
  <script src="javascripts/chronos/jquery.chronos.js"></script>

  <!-- ...and the necessary CSS -->
  <link media="all" type="text/css" href="javascripts/chronos/timeline.css" rel="Stylesheet" charset="utf-8" />
  <link media="all" type="text/css" href="javascripts/ui-lightness/jquery-ui-1.7.2.custom.css" rel="Stylesheet" charset="utf-8" />

  <style>
  body {
         color: #4a5584;
         font-size: 14px;
         font-family: helvetica, arial, sans-serif;
       }
  </style>

  <script>

  $(window).load(
    function() {
      var chronos_config = {
        orientation: 'vertical',
//        startDate:   'Jan 01, 1960 00:00:00',
        url:         'http://slebinos.mit.edu/dev/repertoire-chronos/',
        js_path:     'javascripts/'
      };

      var URLString = document.location.toString(); // Have to do this so we can run .match() on it...?
      var data_url = false;

      // http://spreadsheets.google.com/feeds/list/tXTRNT-JFvyfpFoybaHhltw/1/public/basic?alt=json

      // Really basic check to make sure we've got a google URL and not something else...not rigorous, but will do for demo.
      if (URLString.match('spreadsheets.google.com') && URLString.match('gs_url=(.*)&')) {
        var matches = URLString.match('gs_url=(.*)&')
        chronos_config['data_url']   = decodeURIComponent(matches[1]);
        chronos_config['data_start'] = 'feed.entry';
        chronos_config['date_name']  = 'content.$t.start';
        chronos_config['id_name']    = 'content.$t.eventid';
        chronos_config['title_name'] = 'title.$t';
      } else if (URLString.match('gs_url=(.*)&')) {
        alert("I'm sorry, the URL must be a Google spreadsheets URL. See below for formatting instructions. (Reverting to default data-set.)");
        chronos_config['data_url']   = 'http://slebinos.mit.edu/dev/repertoire-chronos/json.php?url=http%3A%2F%2Fslebinos.mit.edu%2Fus-iran%2Fevents.js%3Fs%3D1910-01-01%26e%3D2000-12-31';
        chronos_config['tag_name']   = 'tags';
      } else {
        chronos_config['data_url']   = 'http://slebinos.mit.edu/dev/repertoire-chronos/json.php?url=http%3A%2F%2Fslebinos.mit.edu%2Fus-iran%2Fevents.js%3Fs%3D1910-01-01%26e%3D2000-12-31';
        chronos_config['tag_name']   = 'tags';
      }

      $('input#horiz').click(function() {
        chronos_config['orientation'] = 'horizontal';
        $('#chronos').chronos(chronos_config);
        return false;
      });

      $('input#vert').click(function() {
        chronos_config['orientation'] = 'vertical';
        $('#chronos').chronos(chronos_config);
        return false;
      });

      $('#chronos').chronos(chronos_config);
    }
  );

  </script>

<title>
  Repertoire Chronos Demo
</title>

</head>

<body>

<!-- BEGIN HTML CODE FOR THE TIMELINE -->

<div id="chronos" class="panelResize"></div>

<!-- END HTML CODE FOR THE TIMELINE -->

<div id="gs">

  <h2>HyperStudio's Repertoire Chronos Timeline</h2>

  <!--
  <p>Change the orientation:</p>
  <form id='orient' name='orient' action='' method='' />
  <input type='radio' id='horiz' name='orientation' value='horizontal' /> Horizontal
  <input type='radio' id='vert' name='orientation' value='vertical' /> Vertical
  </form>
  -->
  <hr size='1'>

  <form id='gs' name='gs' action='' method='GET' />
  <p>Enter your Google Spreadsheet URL here to see your data in the Chronos timeline:<br />
  (for an example, try:<br />
  <a href="http://spreadsheets.google.com/feeds/list/tXTRNT-JFvyfpFoybaHhltw/1/public/basic?alt=json">http://spreadsheets.google.com/feeds/list/tXTRNT-JFvyfpFoybaHhltw/1/public/basic?alt=json</a></p>

  <input type='text' id='gs_field' value='' name='gs_url' size='100' /><br />
  <input type='submit' id='gs_submit' name='gs_submit' value='Update' /><br />
  </form>

  <p>Note that this application expects three fields (column names) to be present in your spreadsheet:</p>
  <ul>
    <li>- start (the field containing the datetime information)</li>
    <li>- eventid (an arbitrary numeric identifier)</li>
    <li>- title (title or description of datetime event)</li>
  </ul>

  <p>For more details on formatting your spreadsheet and generating a URL, see here.</p>

  <hr size='1'>

  <div id='chronos_tags'></div>

  <hr size='1'>

</div>

<!--
<div id="dataMonitor">
-->

<!--
  <div id="thisWidgetTopStuff"><span class='dataTitle'>Currently dragged widget top-related data: </span><span class='data'>0<span></div>

  <div id="secondsToPixels"><span class='dataTitle'>secondsToPixels (currently dragged widget): </span><span class='data'>0<span></div>
  <div id="dragChange"><span class='dataTitle'>dragChange: </span><span class='data'>0<span></div>
  <div id="secondsMoved"><span class='dataTitle'>secondsMoved: </span><span class='data'>0<span></div>
  <div id="pixelsToMove">
    <span class='dataTitle'>pixelsToMove: </span><span class='data'>0<span>
  </div>

  <div id="stpSetting"><span class='dataTitle'>Setting seconds to pixels, what's up?</span><span class='data'></span></div>

  <div id="newStp1"><span class='dataTitle'></span><span class='data'></span></div>
  <div id="newStp2"><span class='dataTitle'></span><span class='data'></span></div>
  <div id="newStp3"><span class='dataTitle'></span><span class='data'></span></div>
  <div id="newStp4"><span class='dataTitle'></span><span class='data'></span></div>

  <div id="scalerPosDebug"><span class='dataTitle'>Scaler Pos Debugging:</span><span class='data'></span></div>
  <div id="dates"><span class='dataTitle'>Dates:</span><span class='data'></span></div>

  <div id="dragtype"><span class='dataTitle'>Scaler Drag type: </span><span class='data'></span></div>

  <div id="initial"><span class='dataTitle'>INITIAL Scaler View Widget data: </span><span class='data'></span></div>
  <div id="stpOld"><span class='dataTitle'>Old STP for Scaler View Widget: </span><span class='data'></span></div>
  <div id="changingStp"><span class='dataTitle'>Changing STP? </span><span class='data'></span></div>
  <div id="stpNew"><span class='dataTitle'>New STP for Scaler View Widget: </span><span class='data'></span></div>
  <div id="preResize"><span class='dataTitle'>Pre-resize data: </span><span class='data'></span></div>
  <div id="postResize"><span class='dataTitle'>Post-resize Widget data: </span><span class='data'></span></div>

  <div id="svw"><span class='dataTitle'>Post-resetting newTop data: </span><span class='data'></span></div>

  <div id="newtop"><span class='dataTitle'>Setting new top on SVW to:</span><span class='data'></span></div>
<!-- -->

  <!-- div id="ow"><span class='dataTitle'>Other Widget data:</span><span class='data'></span></div -->
  <!-- div id="dates"><span class='dataTitle'>Dates:</span><span class='data'></span></div -->

<!--
  <div id="eventListing"><span class='dataTitle'>Selected Event:</span><span class='data'></span></div>

  <div id="debug"></div>
-->

<!--
</div>
-->


</body>
</html>
