<!-- !DOCTYPE html -->
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />

  <!-- requirements: -->
  <script src="javascripts/jquery-1.4.2.min.js"></script>
  <script src="javascripts/jquery-ui-1.8.custom.min.js"></script>

  <!-- using this for demo, just to do tooltip pop-ups a la Simile in horizontal layout. -->
  <script src="javascripts/jquery.tools.min.js"></script>

  <!-- now load Chronos: -->
  <script src="javascripts/chronos/jquery.chronos.js"></script>

  <!-- ...and the necessary CSS -->
  <link media="all" type="text/css" href="javascripts/chronos/timeline.css" rel="Stylesheet" charset="utf-8" />
  <link media="all" type="text/css" href="javascripts/ui-lightness/jquery-ui-1.8.custom.css" rel="Stylesheet" charset="utf-8" />

  <style>
  body {
         color: #4a5584;
         font-size: 14px;
         font-family: helvetica, arial, sans-serif;
       }
  </style>

  <script>

  $(window).load(
    function() {
      var chronos_config = {
        url:         'http://hs-dev.mit.edu/repertoire/chronos/conference/',
        js_path:     'javascripts/',
        orientation: 'vertical',
        startID:     14376864555,
        mapTags:     false,
        useDesc:     true,

        startDate:   'May 20, 2010 18:00:00',

        data_feeds:  [
          {
            feed_name:   'twitter1',
            data_url:    'http://hs-dev.mit.edu/repertoire/chronos/conference/twitter-all.json',
            //data_url:    'http://search.twitter.com/search.json?q=hdigital&rpp=100&page=1&callback=?&since=2010-05-15',
            data_start:  'results',
            date_name:   'created_at',
            id_name:     'id',
            title_name:  'from_user',
            desc_name:   'text',
            // tags_name:   'from_user',
            img_name:    'profile_image_url',
            use_php_filter:  true
          },

          {
            feed_name:   'conference_program',
            data_url:    'http://hs-dev.mit.edu/repertoire/chronos/conference/conference.json',
            data_start:  'conference',
            desc_name:   'desc',
            useDesc:     'false',
            tags_name:   'type',
            use_php_filter:  true
          }
/*
          {
            feed_name:   'flickr_jbp_hdigital',
            data_url:    'http://api.flickr.com/services/feeds/photoset.gne?set=72157624119476364&nsid=49503077999@N01&lang=en-us&format=json',
            data_start:  'items',
            id_name:     'calculate',
            date_name:   'date_taken',
            people_name: 'author',
            desc_name:   'description',
            tags_name:   'tags',
            jsonp:       'jsonFlickrFeed'
          }
*/
        ]
      };

      $('#chronos').chronos(chronos_config);
 
      $('li[data-feed_name=conference_program] span.desc').html(
          function (index, text) {
              if (text.match(/null/)) {
                  return "(no description)";
              } else {
                  $(this).addClass('has_desc');
                  $(this).attr('data-full_desc', text);
                  return text.replace(/^(.{0,50}) .*$/, "$1...");
              }
          }
      );

      $('li[data-feed_name=flickr_jbp_hdigital] span.desc').html(
          function (index, text) {
              alert('wtf.?');
              $(this).addClass('has_desc');
              $(this).attr('data-full_desc', text);
              return text.replace(/<a href=.*><img.*><\/a>/, ' (Pic--click here) ');
          }
      );


      $('span.has_desc').click(
	  function() {
	      if ($(this).attr('data-speaker')) {
                  $('div#desc_display').html('<span class="info_title_heading">' + $(this).attr('data-title') + '</span><span class="info_speaker_heading">' + $(this).attr('data-speaker') + '</span>' + $(this).attr('data-full_desc'));
              } else {
                  $('div#desc_display').html('<span class="info_title_heading">' + $(this).attr('data-title') + '</span>' + $(this).attr('data-full_desc'));
              }
          });


      if (chronos_config.orientation == 'horizontal') {
        // Demoing tooltip (jQuery Tools)
        //$("#timelineYears img.eDot").tooltip({
        $("img.eDot").tooltip({
          // events: { def: "click, mouseout" },  // There's probably a way to get it to close if you click outside, but will require more coding which isn't worth it just yet...

          opacity: 0.65,

          // tweak the position
          offset: [10, 2],

          // use the "slide" effect
          effect: 'toggle'

          // add dynamic plugin with optional configuration for bottom edge
        }).dynamic({ bottom: { direction: 'down', bounce: false } });
      }

    }
  );

  </script>

<title>
  Repertoire Chronos Demo
</title>

</head>

<body>

<!-- BEGIN HTML CODE FOR THE TIMELINE -->

<!-- if I want to prevent 'flopping' in all situations...set height/width (depending on orientation--width for vertical orientation, for example) -->
<div id='container'>

<div id="chronos" class="panelResize"></div>

<!-- END HTML CODE FOR THE TIMELINE -->


<div id="gs">

  <h2>HyperStudio's Chronos Timeline</h2>

  <p><a href="http://hyperstudio.mit.edu/software/repertoire/chronos/">http://hyperstudio.mit.edu/software/repertoire/chronos/</a></p>

  <div id='json_errors'></div>

<!--
  <p id='try_data'>To try your own data set, click here:</p>
  <div id="data_config">

  <form id='gs' name='gs' action='' method='GET'>
  <p>Enter your Google Spreadsheet URL here to see your data in the Chronos timeline:<br />
  (for an example, try:<br />
  <a href="http://spreadsheets.google.com/feeds/list/tXTRNT-JFvyfpFoybaHhltw/1/public/basic?alt=json">http://spreadsheets.google.com/feeds/list/tXTRNT-JFvyfpFoybaHhltw/1/public/basic?alt=json</a></p>

  URL:
  <input type='text' id='gs_field' value='' name='gs_url' size='100' /><br />

  Start date (formatted like "Jan 01, 1960 00:00:00"):
  <input type='text' id='date_field' value='' name='start_date' size='50' /><br />

  Start ID:
  <input type='text' id='startID_field' value='' name='start_id' size='10' /><br />

  <input type='submit' id='gs_submit' name='gs_submit' value='Update' /><br />
  </form>

  <p>Note that this application expects three fields (column names) to be present in your spreadsheet:</p>
  <ul>
    <li>- start (the field containing the datetime information)</li>
    <li>- eventid (an arbitrary numeric identifier)</li>
    <li>- title (title or description of datetime event)</li>
  </ul>

  <p>For more details on formatting your spreadsheet and generating a URL, see here.</p>

  </div>
-->

  <div id='chronos_tags'></div>

  <div id="desc_display"></div>

  <!-- div id="map_canvas" style="width:400px; height:400px"></div -->

</div>


<!--
<div id="dataMonitor">
-->

<!--
  <div id="thisWidgetTopStuff"><span class='dataTitle'>Currently dragged widget top-related data: </span><span class='data'>0<span></div>

  <div id="secondsToPixels"><span class='dataTitle'>secondsToPixels (currently dragged widget): </span><span class='data'>0<span></div>
  <div id="dragChange"><span class='dataTitle'>dragChange: </span><span class='data'>0<span></div>
  <div id="secondsMoved"><span class='dataTitle'>secondsMoved: </span><span class='data'>0<span></div>
  <div id="pixelsToMove">
    <span class='dataTitle'>pixelsToMove: </span><span class='data'>0<span>
  </div>

  <div id="stpSetting"><span class='dataTitle'>Setting seconds to pixels, what's up?</span><span class='data'></span></div>

  <div id="newStp1"><span class='dataTitle'></span><span class='data'></span></div>
  <div id="newStp2"><span class='dataTitle'></span><span class='data'></span></div>
  <div id="newStp3"><span class='dataTitle'></span><span class='data'></span></div>
  <div id="newStp4"><span class='dataTitle'></span><span class='data'></span></div>

  <div id="scalerPosDebug"><span class='dataTitle'>Scaler Pos Debugging:</span><span class='data'></span></div>
  <div id="dates"><span class='dataTitle'>Dates:</span><span class='data'></span></div>
-->


<!--
  <div id="dragtype"><span class='dataTitle'>Scaler Drag type: </span><span class='data'></span></div>
  <div id="initial"><span class='dataTitle'>INITIAL Scaler View Widget data: </span><span class='data'></span></div>
  <div id="stpOld"><span class='dataTitle'>Old STP for Scaler View Widget: </span><span class='data'></span></div>
-->

<!--
  <div id="centerSetDump"><span class='dataTitle'>Center set dump: </span><span class='data'></span></div>
-->

<!--
  <div id="changingStp"><span class='dataTitle'>Changing STP? </span><span class='data'></span></div>
  <div id="stpNew"><span class='dataTitle'>New STP for Scaler View Widget: </span><span class='data'></span></div>

  <div id="preResize"><span class='dataTitle'>Pre-resize data: </span><span class='data'></span></div>
  <div id="postResize"><span class='dataTitle'>Post-resize Widget data: </span><span class='data'></span></div>


  <div id="mousePos"><span class='dataTitle'>Mouse POS data: </span><span class='data'></span></div>

  <div id="svw"><span class='dataTitle'>Post-resetting newTop data: </span><span class='data'></span></div>

  <div id="newtop"><span class='dataTitle'>Setting new top on SVW to:</span><span class='data'></span></div>
-->

  <!-- div id="ow"><span class='dataTitle'>Other Widget data:</span><span class='data'></span></div -->

<!--
  <div id="dates"><span class='dataTitle'>Dates:</span><span class='data'></span></div>
-->

<!--
  <div id="eventListing"><span class='dataTitle'>Selected Event:</span><span class='data'></span></div>
  <div id="debug"></div>
-->

<!--
-->


<div class='clear'></div>

</div>

</body>
</html>
